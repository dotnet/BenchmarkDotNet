<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>FAQ (Frequently asked questions) | BenchmarkDotNet </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="FAQ (Frequently asked questions) | BenchmarkDotNet ">
      
      
      <link rel="icon" href="../logo/icon-32.png">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/dotnet/BenchmarkDotNet/blob/docs-stable/docs/articles/faq.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo/icon.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="docs.faq">
<h1 id="faq-frequently-asked-questions">FAQ (Frequently asked questions)</h1>

<ul>
<li><p><strong>Q</strong> Why can't I install BenchmarkDotNet in Visual Studio 2010/2012/2013?</p>
<p><strong>A</strong> BenchmarkDotNet requires NuGet 3.x+ and can't be installed in old versions of Visual Studio which use NuGet 2.x.
Consider to use Visual Studio 2015/2017 or <a href="https://www.jetbrains.com/rider/">Rider</a>.
See also: <a href="https://github.com/dotnet/BenchmarkDotNet/issues/237">BenchmarkDotNet#237</a>, <a href="https://github.com/dotnet/roslyn/issues/12780">roslyn#12780</a>.</p>
</li>
<li><p><strong>Q</strong> Why can't I install BenchmarkDotNet in a new .NET Core Console App in Visual Studio 2017?</p>
<p><strong>A</strong> BenchmarkDotNet supports only netcoreapp2.0+.
Some old Visual Studio 2017 can create a new application which targets netcoreapp1.0.
You should upgrade it up to 2.0.
If you want to target netcoreapp1.0 in your main assembly, it's recommended to create a separated project for benchmarks.</p>
</li>
<li><p><strong>Q</strong> I created a new .NET Core Console App in Visual Studio 2017. Now I want to run my code on CoreCLR, full .NET Framework, and Mono. How can I do it?</p>
<p><strong>A</strong> Use the following lines in your <code>.csproj</code> file:</p>
<pre><code class="lang-xml">&lt;TargetFrameworks&gt;netcoreapp2.0;net46&lt;/TargetFrameworks&gt;
&lt;PlatformTarget&gt;AnyCPU&lt;/PlatformTarget&gt;
</code></pre>
<p>And mark your benchmark class with the following attributes:</p>
<pre><code class="lang-cs">[CoreJob, ClrJob, MonoJob]
</code></pre>
</li>
<li><p><strong>Q</strong> My source code targets old versions of .NET Framework or .NET Core, but BenchmarkDotNet requires <code>net461</code> and <code>netcoreapp2.0</code>. How can I run benchmarks in this case?</p>
<p><strong>A</strong> It's a good practice to introduce an additional console application (e.g. <code>MyAwesomeLibrary.Benchmarks</code>) which will depend on your code and BenchmarkDotNet.
Due to the fact that users usually run benchmarks in a develop environment and don't distribute benchmarks for users, it shouldn't be a problem.</p>
</li>
<li><p><strong>Q</strong> I wrote a small benchmark, but BenchmarkDotNet requires a lot of time for time measurements. How can I reduce this time?</p>
<p><strong>A</strong> By default, BenchmarkDotNet automatically chooses a number of iterations which allows achieving the best precision.
If you don't need such level of precision and just want to have a quick way to get approximated results, you can specify all parameters manually.
For example, you can use the <code>SimpleJob</code> or <code>ShortRunJob</code> attributes:</p>
<pre><code class="lang-cs">[SimpleJob(launchCount: 1, warmupCount: 3, iterationCount: 5, invocationCount:100, id: &quot;QuickJob&quot;)]
[ShortRunJob]
</code></pre>
</li>
<li><p><strong>Q</strong> My benchmark unexpectedly stopped and I saw the information about error code. What can I do?</p>
<p><strong>A</strong> BenchmarkDotNet generates, builds and runs new process for every benchmark. This behavior is sometimes interpreted by anti-virus as dangerous, and the process is killed. Use <code>EnvironmentAnalyser</code> to detect antivirus software and configure your benchmark to use <a class="xref" href="samples/IntroInProcess.html"><code>InProcessToolchain</code></a>.</p>
</li>
<li><p><strong>Q</strong> Can I run benchmark on the virtual machine?</p>
<p><strong>A</strong> Yes, of course. However, it can affect results because of the shared, physical machine, virtualization process and incorrect <code>Stopwatch.Frequency</code>. If you are unsure whether an application is running on virtual environment, use <code>EnvironmentAnalyser</code> to detect VM hypervisor.</p>
</li>
<li><p><strong>Q</strong> I have failed to run my benchmarks, I am getting following errors about non-optimized dll. What can I do?</p>
<pre><code>Assembly BenchmarkDotNet.Samples which defines benchmarks references non-optimized BenchmarkDotNet
        If you own this dependency, please, build it in RELEASE.
        If you don't, you can create custom config with DontFailOnError to disable our custom policy and allow this b
Assembly BenchmarkDotNet.Samples which defines benchmarks is non-optimized
Benchmark was built without optimization enabled (most probably a DEBUG configuration). Please, build it in RELEASE.
</code></pre>
<p><strong>A</strong> You should always run your benchmarks in RELEASE mode with optimizations enabled (default setting for RELEASE). However if you have to use non-optimized 3rd party assembly you have to create custom config to disable our default policy.</p>
<pre><code class="lang-cs">public class AllowNonOptimized : ManualConfig
{
    public AllowNonOptimized()
    {
        Add(JitOptimizationsValidator.DontFailOnError); // ALLOW NON-OPTIMIZED DLLS

        Add(DefaultConfig.Instance.GetLoggers().ToArray()); // manual config has no loggers by default
        Add(DefaultConfig.Instance.GetExporters().ToArray()); // manual config has no exporters by default
        Add(DefaultConfig.Instance.GetColumnProviders().ToArray()); // manual config has no columns by default
    }
}
</code></pre>
</li>
<li><p><strong>Q</strong> I have failed to run my benchmarks from LINQPad. How can I fix this problem?</p>
<pre><code>Assembly LINQPadQuery which defines benchmarks references non-optimized LINQPad
Assembly LINQPadQuery which defines benchmarks is non-optimized
Benchmark was built without optimization enabled (most probably a DEBUG configuration). Please, build it in RELEASE.
</code></pre>
<p><strong>A</strong> You need to make sure that you are using <strong>AnyCPU</strong> 5.22.05+ build of LINQPad with optimizations enabled. To enable the optimizations you need to go to Preferences -&gt; Query and select <code>compile with /optimize+</code></p>
</li>
<li><p><strong>Q</strong> I'm trying to use <code>RPlotExporter</code> but there are no any images in the <code>results</code> folder</p>
<p><strong>A</strong> Try to specify <code>R_LIBS_USER</code> (e.g. <code>R_LIBS_USER=/usr/local/lib/R/</code> on Linux/macOS, see also: <a href="https://github.com/dotnet/BenchmarkDotNet/issues/692">#692</a>)</p>
</li>
<li><p><strong>Q</strong> My benchmark failed with OutOfMemoryException. How can I fix this problem?</p>
<p><strong>A</strong> BenchmarkDotNet continues to run additional iterations until desired accuracy level is achieved. It's possible only if the benchmark method doesn't have any side-effects.
If your benchmark allocates memory and keeps it alive, you are creating a memory leak.</p>
<p>You should redesign your benchmark and remove the side-effects. You can use <code>OperationsPerInvoke</code>, <code>IterationSetup</code> and <code>IterationCleanup</code> to do that.</p>
<p>An example:</p>
<pre><code class="lang-cs">public class OOM
{
    private StringBuilder buffer = new StringBuilder();

    [Benchmark]
    public void HasSideEffects()
    {
        // This method is growing the buffer to infinity
        // because it's executed millions of times
        buffer.Append('a');
    }

    [Benchmark(OperationsPerInvoke = 16)]
    public void HasNoSideEffects()
    {
        buffer.Clear();

        for (int i = 0; i &lt; 1024; i++)
            buffer.Append('a');
    }
}
</code></pre>
</li>
</ul>

</article>


        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          Copyright &copy; 2013–2024 .NET Foundation and contributors
        </div>
      </div>
    </footer>
  </body>
</html>
