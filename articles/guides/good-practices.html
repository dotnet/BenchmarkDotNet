<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Good Practices | BenchmarkDotNet </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Good Practices | BenchmarkDotNet ">
      
      
      <link rel="icon" href="../../logo/icon-32.png">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/dotnet/BenchmarkDotNet/blob/master/docs/articles/guides/good-practices.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo/icon.svg" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="good-practices">Good Practices</h1>

<h2 id="use-the-release-build-without-an-attached-debugger">Use the Release build without an attached debugger</h2>
<p>Never use the Debug build for benchmarking. <em>Never</em>. The debug version of the target method can run 10–100 times slower.
The release mode means that you should have <code>&lt;Optimize&gt;true&lt;/Optimize&gt;</code> in your csproj file
or use <a href="https://learn.microsoft.com/dotnet/csharp/language-reference/compiler-options/">/optimize</a> for <code>csc</code>. Also, never
use an attached debugger (e.g. Visual Studio or WinDbg) during the benchmarking. The best way is
build our benchmark in the Release mode and run it from the command line.</p>
<h2 id="try-different-environments">Try different environments</h2>
<p>Please, don't extrapolate your results. Or do it very carefully.
I remind you again: the results in different environments may vary significantly. If a <code>Foo1</code> method is faster than
a <code>Foo2</code> method for CLR4, .NET Framework 4.5, x64, RyuJIT, Windows, it means that the <code>Foo1</code> method is faster than
the <code>Foo2</code> method for CLR4, .NET Framework 4.5, x64, RyuJIT, Windows and nothing else. And you can not say anything
about methods performance for CLR 2 or .NET Framework 4.6 or LegacyJIT-x64 or x86 or Linux+Mono until you try it.</p>
<h2 id="avoid-dead-code-elimination">Avoid dead code elimination</h2>
<p>You should also use the result of calculation. For example, if you run the following code:</p>
<pre><code class="lang-cs">void Foo()
{
    Math.Exp(1);
}
</code></pre>
<p>then JIT can eliminate this code because the result of <code>Math.Exp</code> is not used. The better way is use it like this:</p>
<pre><code class="lang-cs">double Foo()
{
    return Math.Exp(1);
}
</code></pre>
<h2 id="power-settings-and-other-applications">Power settings and other applications</h2>
<ul>
<li>Turn off all of the applications except the benchmark process and the standard OS processes. If you run benchmark and work in the Visual Studio at the same time, it can negatively affect to benchmark results.</li>
<li>If you use laptop for benchmarking, keep it plugged in and use the maximum performance mode.</li>
</ul>

</article>


        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          Copyright &copy; 2013–2024 .NET Foundation and contributors
        </div>
      </div>
    </footer>
  </body>
</html>
